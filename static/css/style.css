/* ═══════════════════════════════════════════════════════════════════
   BTwin — Battery Digital Twin Dashboard
   Terminal green-on-black theme — single source of truth, no duplicates
   ═══════════════════════════════════════════════════════════════════ */

/* ── Reset ──────────────────────────────────────────────────────── */
*, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    overflow-x: hidden;
}

body {
    font-family: 'Courier New', Courier, monospace;
    background: #000;
    color: #00ff00;
    min-height: 100vh;
    font-size: 14px;
}

/* ── Terminal shell ─────────────────────────────────────────────── */
.terminal {
    min-height: 100vh;
    background: #000;
    border: 2px solid #00ff00;
    margin: 6px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* ── Header ─────────────────────────────────────────────────────── */
.terminal-header {
    background: #001100;
    border-bottom: 1px solid #00ff00;
    padding: 10px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
    flex-shrink: 0;
}

.terminal-title {
    font-size: 1.1em;
    font-weight: bold;
    color: #00ff00;
    text-shadow: 0 0 8px #00ff00;
    white-space: nowrap;
}

.terminal-status {
    display: flex;
    gap: 16px;
    align-items: center;
    font-size: 0.85em;
    flex-wrap: wrap;
}

.status-connected    { color: #00ff00; text-shadow: 0 0 4px #00ff00; }
.status-disconnected { color: #ff3333; text-shadow: 0 0 4px #ff3333; }

/* ── DFN Status Banner ──────────────────────────────────────────── */
.dfn-banner {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 16px;
    border-bottom: 1px solid #003300;
    font-size: 0.82em;
    flex-wrap: wrap;
    gap: 6px;
    background: #001a00;
    transition: background 0.4s, border-color 0.4s;
    flex-shrink: 0;
}
.dfn-banner-ready { background: #001500; border-color: #00cc00; }
.dfn-banner-error { background: #1a0000; border-color: #cc0000; }

.dfn-banner-left  { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
.dfn-banner-right { font-size: 0.82em; color: #009900; min-width: 0; word-break: break-word; }

.dfn-label      { font-weight: bold; color: #00ff00; letter-spacing: 1px; }
.dfn-param-info { color: #00aaff; }

.dfn-indicator             { font-weight: bold; }
.dfn-indicator.dfn-ready   { color: #00ff00; }
.dfn-indicator.dfn-init    { color: #ffaa00; animation: blink 1.2s step-end infinite; }
.dfn-indicator.dfn-error   { color: #ff4444; }

/* ── Scrollable content ─────────────────────────────────────────── */
.terminal-content {
    padding: 14px 16px;
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
}

/* ── Section titles ─────────────────────────────────────────────── */
.section-title {
    color: #00ff00;
    font-size: 0.9em;
    font-weight: bold;
    margin-bottom: 10px;
    border-bottom: 1px solid #003300;
    padding-bottom: 4px;
    text-shadow: 0 0 4px #00ff00;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* ── Metrics ────────────────────────────────────────────────────── */
.metrics-section { margin-bottom: 20px; }

.metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.metric-item {
    background: #001100;
    border: 1px solid #003300;
    padding: 10px 12px;
    display: flex;
    flex-direction: column;
    gap: 3px;
    min-width: 0;
}

.metric-label {
    color: #009900;
    font-size: 0.7em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.metric-value {
    color: #00ff00;
    font-size: 1.5em;
    font-weight: bold;
    text-shadow: 0 0 5px #00ff00;
    line-height: 1.1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.metric-unit { color: #006600; font-size: 0.75em; }

.ekf-value {
    color: #00ffff !important;
    text-shadow: 0 0 5px #00ffff !important;
}

/* ── DFN Physics Panel ──────────────────────────────────────────── */
.dfn-section {
    margin-bottom: 20px;
    border: 1px solid #003300;
    background: #000800;
    padding: 12px;
}

.dfn-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin-top: 10px;
}

.dfn-metric {
    background: #001100;
    border: 1px solid #002200;
    padding: 8px 6px;
    text-align: center;
    min-width: 0;
}

.dfn-metric-label {
    font-size: 0.68em;
    color: #008800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-metric-value {
    font-size: 1.15em;
    font-weight: bold;
    color: #00ffff;
    text-shadow: 0 0 5px #00ffff;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-metric-unit { font-size: 0.68em; color: #005500; margin-top: 2px; }

/* ── Gauges ─────────────────────────────────────────────────────── */
.gauges-section { margin-bottom: 20px; }

.gauges-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.gauge-container {
    background: #001100;
    border: 1px solid #003300;
    padding: 10px;
    min-width: 0;
}

.gauge-title {
    color: #009900;
    font-size: 0.72em;
    text-align: center;
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#voltageGauge, #tempGauge, #socGauge, #sohGauge {
    height: 200px;
    width: 100%;
}

/* ── Charts ─────────────────────────────────────────────────────── */
.charts-section { margin-bottom: 20px; }

.charts-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

.charts-grid.charts-single { grid-template-columns: 1fr; }

.chart-container {
    background: #001100;
    border: 1px solid #003300;
    padding: 10px;
    min-width: 0;
}

.chart-title {
    color: #009900;
    font-size: 0.72em;
    text-align: center;
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#voltageChart, #socChart { height: 260px; width: 100%; }
#ocvChart                { height: 280px; width: 100%; }

/* ── Footer ─────────────────────────────────────────────────────── */
.terminal-footer {
    background: #001100;
    border-top: 1px solid #00ff00;
    padding: 6px 16px;
    text-align: center;
    font-size: 0.72em;
    color: #006600;
    flex-shrink: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* ── Animations ─────────────────────────────────────────────────── */
@keyframes blink {
    0%, 100% { opacity: 1; }
    50%       { opacity: 0.25; }
}

/* ═══════════════════════════════════════════════════════════════════
   Responsive — tablet landscape (≤1100px): collapse gauges to 2×2
   ═══════════════════════════════════════════════════════════════════ */
@media (max-width: 1100px) {
    .gauges-grid { grid-template-columns: repeat(2, 1fr); }
}

/* ═══════════════════════════════════════════════════════════════════
   Responsive — tablet portrait (≤800px)
   ═══════════════════════════════════════════════════════════════════ */
@media (max-width: 800px) {
    .terminal { margin: 3px; }

    .metrics-grid { grid-template-columns: repeat(2, 1fr); gap: 8px; }
    .dfn-grid     { grid-template-columns: repeat(2, 1fr); gap: 6px; }
    .gauges-grid  { grid-template-columns: repeat(2, 1fr); gap: 8px; }
    .charts-grid  { grid-template-columns: 1fr; }

    .metric-value { font-size: 1.3em; }

    #voltageGauge, #tempGauge, #socGauge, #sohGauge { height: 180px; }
    #voltageChart, #socChart { height: 220px; }
    #ocvChart { height: 240px; }

    .dfn-banner    { flex-direction: column; align-items: flex-start; }
    .terminal-footer { white-space: normal; }
}

/* ═══════════════════════════════════════════════════════════════════
   Responsive — phone (≤480px)
   ═══════════════════════════════════════════════════════════════════ */
@media (max-width: 480px) {
    .terminal {
        margin: 0;
        border-width: 1px;
        border-left: none;
        border-right: none;
    }

    .terminal-header  { flex-direction: column; text-align: center; padding: 8px 10px; }
    .terminal-title   { font-size: 0.9em; }
    .terminal-status  { justify-content: center; font-size: 0.75em; gap: 8px; }
    .terminal-content { padding: 8px 10px; }

    .metrics-grid { grid-template-columns: repeat(2, 1fr); gap: 6px; }
    .dfn-grid     { grid-template-columns: repeat(2, 1fr); gap: 5px; }
    .gauges-grid  { grid-template-columns: 1fr; }

    .metric-item      { padding: 8px; }
    .metric-value     { font-size: 1.2em; }
    .dfn-metric-value { font-size: 1em; }

    #voltageGauge, #tempGauge, #socGauge, #sohGauge { height: 160px; }
    #voltageChart, #socChart { height: 200px; }
    #ocvChart { height: 210px; }

    .terminal-footer { font-size: 0.65em; white-space: normal; }
}
